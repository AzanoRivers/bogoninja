---
/**
 * FloatingFormButton Component - Botón flotante para scroll hacia el formulario
 * 
 * @description
 * Botón flotante con ícono de editar que hace scroll suave hacia la sección del formulario.
 * Inferior izquierda en mobile, superior izquierda en desktop.
 * 
 * @author AzanoRivers
 * @ai Claude Sonnet 4.5 (GitHub Copilot)
 */

interface Props {
    targetId?: string;
    className?: string;
}

const { targetId = "formulario-section", className = "" } = Astro.props;
---

<button
    type="button"
    id="floating-form-button"
    class={`fixed z-999 bg-ninja-dark-blue/30 backdrop-blur-sm p-3 sm:p-3.5 md:p-4 rounded-lg border border-ninja-dark-pink/40 transition-all duration-300 hover:bg-ninja-dark-blue/50 hover:border-ninja-light-pink hover:shadow-lg hover:shadow-ninja-light-pink/20 active:scale-95 cursor-pointer sm:bottom-4 sm:left-4 xl:top-4 xl:left-4 xl:bottom-auto ${className}`}
    aria-label="Ir al formulario de registro"
    data-scroll-to={targetId}
>
    <svg
        class="sm:w-5 sm:h-5 md:w-6 md:h-6 xl:w-7 xl:h-7"
        viewBox="0 0 16 16"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
    >
        <path 
            d="M13 0L16 3L9 10H6V7L13 0Z" 
            class="fill-ninja-light-pink/30 stroke-ninja-light-pink"
            stroke-width="0.5"
        />
        <path 
            d="M1 1V15H15V9H13V13H3V3H7V1H1Z" 
            class="fill-ninja-light-pink/30 stroke-ninja-light-pink"
            stroke-width="0.5"
        />
    </svg>
</button>

<style>
    #floating-form-button {
        animation: fadeInUp 0.6s ease-out forwards;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>

<script is:inline>
    function initFloatingButton() {
        const button = document.getElementById('floating-form-button');
        if (!button) return;

        button.addEventListener('click', function() {
            // Buscar ambas instancias del formulario (mobile y desktop)
            const mobileTarget = document.getElementById('formulario-mobile');
            const desktopTarget = document.getElementById('formulario-desktop');
            
            // Determinar cuál está visible
            let targetElement = null;
            if (mobileTarget && mobileTarget.offsetParent !== null) {
                targetElement = mobileTarget;
            } else if (desktopTarget && desktopTarget.offsetParent !== null) {
                targetElement = desktopTarget;
            }

            if (!targetElement) return;

            targetElement.scrollIntoView({
                behavior: 'smooth',
                block: 'center'
            });
        });
    }

    // Ejecutar inmediatamente
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initFloatingButton);
    } else {
        initFloatingButton();
    }
</script>
