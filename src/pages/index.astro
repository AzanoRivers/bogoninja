---
import { MainLayout, MobileContent, DesktopContent, Footer } from "@/layout";
import { Header, BlockText, VideoBox, ImageShadow, FloatingFormButton, Badge, ContactForm, Accordion } from "@/components";
import { getEntry } from 'astro:content';

// Pre-renderizar esta página como estática (equivalente a hybrid mode)
export const prerender = true;

const homeContent = await getEntry('home', 'es');
const formContent = await getEntry('form', 'es');

const formTexts = {
	nameLabel: formContent?.data.name_label ?? "",
	namePlaceholder: formContent?.data.name_placeholder ?? "",
	improveLabel: formContent?.data.improve_label ?? "",
	improvePlaceholder: formContent?.data.improve_placeholder ?? "",
	experienceLabel: formContent?.data.experience_label ?? "",
	experiencePlaceholder: formContent?.data.experience_placeholder ?? "",
	locationLabel: formContent?.data.location_label ?? "",
	locationOption1: formContent?.data.location_option_1 ?? "",
	locationOption2: formContent?.data.location_option_2 ?? "",
	locationOption3: formContent?.data.location_option_3 ?? "",
	emailLabel: formContent?.data.email_label ?? "",
	emailPlaceholder: formContent?.data.email_placeholder ?? "",
	submitButton: formContent?.data.submit_button ?? "",
	errorNameRequired: formContent?.data.error_name_required ?? "",
	errorImproveRequired: formContent?.data.error_improve_required ?? "",
	errorEmailRequired: formContent?.data.error_email_required ?? "",
	errorEmailInvalid: formContent?.data.error_email_invalid ?? "",
	errorLocationRequired: formContent?.data.error_location_required ?? "",
	successMessage: formContent?.data.success_message ?? "",
	captchaLabel: formContent?.data.captcha_label ?? "",
	errorCooldown: formContent?.data.error_cooldown ?? "",
	cooldownInfo: formContent?.data.cooldown_info ?? "",
	info_2: formContent?.data.info_2 ?? "",
};
---

<MainLayout>
	<!-- Headers Mobile/Desktop -->
	<Header className="xl:hidden w-full sticky top-0 z-50 bg-ninja-dark-blue/80 rounded-b-xl" />
	<!-- VideoBox Desktop -->
	<section class="absolute top-0 right-[20%] hidden xl:flex w-[35%] h-max xl:mt-20 xl:z-40 justify-center items-start mystic-shadow-static-slow">
		<VideoBox className="w-full xl:h-[40dvh]" />
	</section>
	<section class="w-full xl:h-dvh sm:mt-4 md:mt-6 lg:mt-8 xl:mt-0 h-max mystic-shadow xl:flex xl:flex-row xl:items-end xl:gap-6 xl:overflow-hidden">
		<ImageShadow
			src="/images/centroastrobog.jpg"
			alt="Centro Astro Bog"
			author="@lumiere.atelier.co"
			loading="eager"
			className="sm:float-left xl:float-none w-1/2 xl:w-auto sm:h-80 md:h-90 lg:h-100 xl:h-150"
		/>
		<div class="xl:max-w-[45%] xl:flex xl:flex-col xl:justify-end xl:flex-1 xl:mb-28">
			<BlockText text={homeContent?.data.intro_1 ?? ""} />
			<BlockText className="mt-2" text={homeContent?.data.intro_2 ?? ""} />
		</div>
	</section>
	<!-- VideoBox Mobile -->
	<section class="flex xl:hidden w-full h-max sm:mt-6 md:mt-10 lg:mt-20 justify-center items-start mystic-shadow-static-slow">
		<VideoBox className="w-[75%] sm:h-40 md:h-60 lg:h-80 sm:mt-2 md:mt-3 lg:mt-6" />
	</section>

	<!-- Header Desktop - fijo en la parte inferior -->
	<Header className="hidden xl:block xl:z-50" />
	
	<!-- Contenido Mobile-->
	<MobileContent />

	<!-- Contenido Desktop-->
	<DesktopContent />

	<!-- Badge + Formulario + Footer (compartidos) -->
	<article class="w-full xl:w-[50%] xl:mx-auto h-max scroll-reveal sm:mt-8 md:mt-6 lg:mt-4 px-2 xl:px-0">
		<Badge message={homeContent?.data.warning_1 ?? ""} />
	</article>
	<section id="formulario" class="w-full h-max scroll-reveal sm:mt-8 md:mt-6 sm:mb-8 lg:mb-24 xl:flex xl:justify-center xl:items-center px-2 xl:px-0">
		<div class="w-full xl:w-[50%] xl:mb-6">
			<Accordion title="¡Vamos! - Toca aquí">
				<ContactForm client:visible texts={formTexts} />
			</Accordion>
		</div>
	</section>
	<Footer />

	<!-- Botón flotante - único en todo el DOM -->
	<FloatingFormButton />

	<!-- Accordeon preguntas frecuentes -->
	<section id="frequently-ask" class="w-full h-max scroll-reveal sm:mt-8 md:mt-6 sm:mb-8 lg:mb-24 xl:flex xl:justify-center xl:items-center px-2 xl:px-0">
		<div class="w-full xl:w-[50%] xl:mb-6">
			<Accordion title="Preguntas Frecuentes - FAQ">
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. 
					Quisquam, modi. Odio hic, optio laudantium ipsam asperiores voluptatibus sint rem consequuntur odit 
					ut beatae. Praesentium architecto doloribus saepe vero, tenetur consequuntur?
				</p>
			</Accordion>
		</div>
	</section>

	<!-- Epitafio - Texto final -->
	<section class="w-full flex justify-center flex-col items-center px-4 sm:pb-16 md:pb-20 lg:pb-24 xl:pb-24">
		<p class="text-ninja-light-pink/60 font-lato sm:text-sm md:text-base lg:text-lg xl:text-xl font-light sm:text-left xl:text-center italic max-w-4xl">
			Bogotá, fría, distópica, pero amada Bogotá, ciudad de todos, o para unos pocos…
		</p>
		<p class="mt-4 text-ninja-light-pink/60 font-lato sm:text-xs md:text-xs lg:text-base font-light sm:text-left xl:text-center italic max-w-4xl">
			{homeContent?.data.author_disclaimer ?? ""}
		</p>
	</section>

</MainLayout>
